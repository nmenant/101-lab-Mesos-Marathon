--- #install mesos and marathon on masters
- hosts: masters
  remote_user: user
  become: yes
  become_method: sudo
  connection: ssh
  gather_facts: no
  vars:
    var1: value
  tasks:
  - fail: msg=”Installation Failed, this is not Ubuntu”
    when: “ansible_os_family != ‘Debian’”
  - name: Install list of packages
    apt: name={{item}} state=installed update_cache=yes
    with_items:
      - openjdk-8-jdk
      - build-essential
      - python-dev 
      - libcurl4-nss-dev
      - libsasl2-dev
      - libsasl2-modules
      - maven
      - libapr1-dev
      - libsvn-dev
      - unzip
  - name: Add key for Mesosphere repository
    apt_key: url=http://keyserver.ubuntu.com/pks/lookup?op=get&fingerprint=on&search=0xE56151BF state=present
    sudo: yes
  - name: Determine Linux distribution distributor
    shell: lsb_release -is | tr '[:upper:]' '[:lower:]'
    register: release_distributor
  - name: Determine Linux distribution codename
    command: lsb_release -cs
    register: release_codename
  - name: Add Mesosphere repository to sources list
    copy:
      content: "deb http://repos.mesosphere.io/{{release_distributor.stdout}} {{release_codename.stdout}} main"
      dest: /etc/apt/sources.list.d/mesosphere.list
      mode: 0644
    sudo: yes
  - name: install mesos and marathon
    apt: name={{item}} state=installed update_cache=yes
    with_items:
      - mesos
      - marathon
